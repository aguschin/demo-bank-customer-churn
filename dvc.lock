schema: '2.0'
stages:
  data_split:
    cmd: python stages/data_split.py --config=params.yaml
    deps:
    - path: data/Churn_Modelling.csv
      md5: e61c41c002281a32aa8f1e2c0e6ff3d5
      size: 684450
    - path: stages/data_split.py
      md5: 519fbe22a8ce712999f28010f3c56fe6
      size: 1606
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
        data_split:
          test_size: 0.25
    outs:
    - path: data/X_test.pkl
      md5: f80ed84ef9839c40a73acbb43d954b24
      size: 185913
    - path: data/X_train.pkl
      md5: 9032de86ff3b1211e42e35e8fc2f7176
      size: 555636
    - path: data/y_test.pkl
      md5: 2b92d760f822324119c0293ef0c9bf4f
      size: 60556
    - path: data/y_train.pkl
      md5: 2548a5ebe12402823fd9ee4965d14b27
      size: 180469
  train:
    cmd: python stages/train.py --config=params.yaml
    deps:
    - path: data/X_train.pkl
      md5: 9032de86ff3b1211e42e35e8fc2f7176
      size: 555636
    - path: data/y_train.pkl
      md5: 2548a5ebe12402823fd9ee4965d14b27
      size: 180469
    - path: stages/train.py
      md5: d54e4eaf7ad9f7c5bb9a740d48a2f9d2
      size: 2536
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
        train:
          model_type: randomforest
          params:
            n_estimators: 200
            max_depth: 20
    outs:
    - path: model//clf-model
      md5: f60f1988025b5177e190c61bab87eae4
      size: 27466666
    - path: model//clf-model.mlem
      md5: dbada813b5606bb3a0a81ef350fa452d
      size: 1995
  eval:
    cmd: python stages/eval.py --config=params.yaml
    deps:
    - path: data/X_test.pkl
      md5: f80ed84ef9839c40a73acbb43d954b24
      size: 185913
    - path: data/y_test.pkl
      md5: 2b92d760f822324119c0293ef0c9bf4f
      size: 60556
    - path: model//clf-model
      md5: f60f1988025b5177e190c61bab87eae4
      size: 27466666
    - path: model//clf-model.mlem
      md5: dbada813b5606bb3a0a81ef350fa452d
      size: 1995
    - path: stages/eval.py
      md5: 0f8bd41fc66ef9117d6e3451a3ed3631
      size: 2700
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
        data_split:
          test_size: 0.25
        train:
          model_type: randomforest
          params:
            n_estimators: 200
            max_depth: 20
    outs:
    - path: eval_plots/cm.png
      md5: 234b122f3992091807fb5a3f316c6895
      size: 10210
    - path: eval_plots/plots/sklearn/roc.json
      md5: 8c471daca995d24f6e1cf6f2595070a5
      size: 83237
    - path: feat_imp.csv
      md5: b138d0ecead606b251595f46df580c9d
      size: 301
    - path: metrics.json
      md5: 3073314fb45d090aa00c9a5fc119c5cd
      size: 66
    - path: models/perm_imp.joblib
      md5: 75e6cf790f19f373898eee08880ce288
      size: 27464395
